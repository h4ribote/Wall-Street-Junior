# AI Traders & Bot Ecosystem

## 1. リアルタイム要素とボット (Real-time & Bots)
Paper Street では、実際の市場と同様に、取引の大半はボットが担います。これにより、プレイヤーが常にリアルな価格変動と流動性（Order Bookの厚み）を感じられる環境を提供します。

### 1.1. ボットの役割 (Bot Roles)
板情報（Order Book）は、プレイヤーだけでなく、以下の多様なロジックを持つボット群によって駆動されます。
「成行特化型（Market Order Specialist）」と「指値特化型（Limit Order Specialist）」を明確に区別し、それぞれが異なる役割で市場に参加します。

1.  **Market Makers (流動性供給 - 指値特化)**:
    *   常に現在価格の上下にBuy/Sellの指値注文を出し続け、スプレッド（売値と買値の差）を維持します。
    *   市場に厚みを持たせ、プレイヤーがいつでも売買できるようにします。
2.  **Momentum Chasers (順張り - 成行特化)**:
    *   トレンドフォロワーの一種。ブレイクアウト時に即座に成行でエントリーし、トレンドを加速させます。
    *   相場の「勢い」を作り出す役割を担います。
3.  **Dip Buyers (順張り - 指値特化)**:
    *   トレンドフォロワーの一種。上昇トレンド中の押し目（Pullback）を待ち、有利な価格で指値エントリーします。
    *   トレンド継続のためのサポートラインを形成します。
4.  **Reversal Snipers (逆張り - 成行特化)**:
    *   ミーンリバーターの一種。極端な価格スパイク（オーバーシュート）に対して即座に成行で逆張りを行います。
    *   過熱した相場を瞬時に是正する役割を担います。
5.  **Grid Traders (逆張り - 指値特化)**:
    *   ミーンリバーターの一種。支持線・抵抗線付近のゾーンに指値を網の目のように配置（グリッド）し、反転を待ち伏せします。
    *   レンジ相場での流動性供給と価格安定化に寄与します。
6.  **Whales / Institutional (機関投資家 - ハイブリッド)**:
    *   膨大な資金を持ち、定期的に大量の注文（実需）を執行します。
    *   アイスバーグ注文（見せ板隠し）なども使用し、市場にインパクトを与えるイベント的な存在です。
7.  **News Reactors (ヘッドライン取引 - 主に成行)**:
    *   ゲーム内のニュースフィードに反応し、ミリ秒単位で「ポジティブなら買い」「ネガティブなら売り」を行うHFT（高頻度取引）ボットです。
8.  **National AI (中央銀行/国家介入 - ハイブリッド)**:
    *   [ECONOMY.md](./ECONOMY.md) で定義された国家の市場介入を実行する特別なボットです。
    *   マクロ経済指標や市場の健全性（ボラティリティ、流動性）を監視し、必要に応じて大規模な買い支えや売り浴びせを行います。


## 2. Botの挙動改善と脆弱性対策 (Bot Intelligence)
単純なアルゴリズムBotはプレイヤーに見切られ、搾取されるリスクがあります。これを防ぐため、高度なロジックと多様性を導入します。

### 2.1. アルゴリズムの多様化と隠蔽 (Diversity & Obfuscation)
*   **パラメータのランダム化**: Botごとに使用するテクニカル指標のパラメーター（期間、閾値など）を微妙にズラし、行動のタイミングを分散させます。
*   **反応遅延 (Jitter)**: ニュースやシグナルに対する反応速度にランダムな遅延を持たせ、機械的な動きを隠蔽します。これにより、プレイヤーがBotの動きを完全に予測することを難しくします。

### 2.2. 適応 (Learning & Adaptation)
*   **適応的パラメータ調整 (Adaptive Parameters)**: 「過去一定期間に損失を出した戦略」の重みを一時的に下げるロジックを実装し、単純な攻略法への耐性を高めます。
*   **「噂」と「事実」の区別**: ニュース発表前に、一部のBotが「噂で買って事実で売る」動きをするように設定し、ニュース＝即買いという単純な攻略法を封じます。
*   **誤報への反応**: たまにsentimentと逆の価格変動を起こす（材料出尽くし、または誤報）イベントを混ぜ、プレイヤーの裏をかく動きを見せます。


## 3. ボットロジックの詳細 (Bot Logic Details)

### 3.1. Market Maker Logic (マーケットメイカー)
*   **目的**: 流動性の供給とスプレッドからの収益確保。
*   **挙動**:
    *   中間価格（Mid-price）の上下に指値の買い注文と売り注文を出します。
    *   **在庫リスク管理 (Inventory Risk Management)**: 現在の在庫状況に基づいて提示価格を調整します。ロングポジションを持ちすぎている場合は、買いと売りの価格を両方下げて、売りを促進し買いを抑制します。
    *   **スプレッド計算 (Spread Calculation)**: `スプレッド = 基本スプレッド * (1 + ボラティリティ乗数)`。ボラティリティが高い時はスプレッドを広げます。
    *   **注文更新 (Order Refresh)**: 定期的、または価格が大きく変動した際に、注文をキャンセルして再発注します。

### 3.2. Momentum Chaser Logic (順張り - 成行特化)
*   **目的**: 強いトレンド発生時に飛び乗り、短期的な利益を最大化する。
*   **指標**: MACD, ADX, Volume Spike。
*   **挙動**:
    *   **特徴**: 機会損失を最も嫌います。スリッページを許容し、必ず成行注文（Market Order）を使用します。
    *   **エントリー**:
        *   **ブレイクアウト**: 価格が直近の高値/安値を更新し、かつ出来高が急増した瞬間にエントリーします。
        *   **ゴールデンクロス**: 短期MAが長期MAを勢いよく突き抜け、ADXが25以上（強いトレンド）を示している場合にエントリーします。
    *   **エグジット**:
        *   トレーリングストップ（価格のピークから一定％下落）で成行決済します。
        *   RSIなどでダイバージェンス（価格は更新したがオシレーターは下がっている）が発生した瞬間に逃げます。

### 3.3. Dip Buyer Logic (順張り - 指値特化)
*   **目的**: トレンド中の調整局面（押し目/戻り目）で有利な価格で参入する。
*   **指標**: SMA/EMA, Fibonacci Retracement, Bollinger Bands。
*   **挙動**:
    *   **特徴**: コスト意識が高く、スプレッドを支払うことを嫌います。指値注文（Limit Order）を使用し、Maker手数料（リベート）を狙います。
    *   **エントリー**:
        *   **押し目買い**: 上昇トレンド中、価格が短期MA（例: 20EMA）やボリンジャーバンド中間線まで戻るのを待ち、そこに指値を置きます。
        *   **サポレジ転換**: 直近で抵抗線だった価格帯が支持線に変わることを予測し、そのライン上に指値を配置します。
    *   **エグジット**:
        *   直近高値やフィボナッチ・エクステンション（1.618倍など）に指値決済注文（利食い）を置きます。
        *   約定しないままトレンドが終わった場合は、微益または建値でキャンセル・撤退します。

### 3.4. Reversal Sniper Logic (逆張り - 成行特化)
*   **目的**: 瞬間的な価格の行き過ぎ（オーバーシュート）を狙い撃ちし、リバウンドを取る（スキャルピング）。
*   **指標**: Bollinger Bands (3σ), RSI (Extreme), ATR。
*   **挙動**:
    *   **特徴**: 速度重視。市場のパニックや熱狂を利用します。
    *   **エントリー**:
        *   **クライマックス**: 価格がボリンジャーバンドの3σを大きく超え、かつRSIが極端な値（90以上や10以下）を記録した瞬間に成行で逆張りします。
        *   **ニュース直後**: ニュース発表直後の乱高下（ヒゲ）を狙ってエントリーします。
    *   **エグジット**:
        *   価格がボリンジャーバンド内（2σまたは1σ）に戻った瞬間に即座に成行決済します。保有時間は数秒〜数分と極めて短いです。
    *   **リスク管理**: 予想に反してバンドウォーク（トレンド継続）が起きた場合は、即座に損切りします。

### 3.5. Grid Trader Logic (逆張り - 指値特化)
*   **目的**: レンジ相場で価格の上下動を繰り返し利益に変える。
*   **指標**: Support/Resistance Lines, Pivot Points, Envelopes。
*   **挙動**:
    *   **特徴**: ゾーン（面）で待ち構えます。一度のエントリーで全力を出さず、資金を分割してリスクを分散します。
    *   **エントリー**:
        *   **グリッド展開**: ボリンジャーバンド2σから3σの間、あるいは過去の強い支持線/抵抗線ゾーンに、等間隔で複数の指値を配置します。
        *   **ナンピン**: 価格が逆行しても、計画的にポジションを追加（平均取得単価の引き下げ）しながら反転を待ちます。
    *   **エグジット**:
        *   各ポジション、または全ポジションの平均取得単価から一定の利益（例: 0.5%）が出たポイントに指値決済を置きます。
    *   **リスク管理**: 一定ラインを超えて明確なトレンドが発生してしまった場合は、全ポジションをロスカットします（これが遅れると破綻します）。

### 3.6. Whale / Institutional Logic (クジラ / 機関投資家)
*   **目的**: 市場への影響を最小限に抑えて大口注文を執行する、または価格を操作する。
*   **挙動**:
    *   **TWAP/VWAP**: 大口注文を時間の経過とともに平均価格に合わせて小さな塊に分割して執行します。
    *   **アイスバーグ注文 (Iceberg Orders)**: 大きな指値注文を出しますが、オーダーブックにはそのごく一部しか表示しません。
    *   **インパクト**: 時折、流動性を一掃しストップロスを誘発するために、大きな成行注文を実行します（ストップ狩り）。

### 3.7. News Reactor Logic (ニュースリアクター)
*   **目的**: ニュースのセンチメントに基づいて即座に取引する。
*   **挙動**:
    *   ニュースの見出しからキーワードとセンチメントスコア（ポジティブ/ネガティブ）を解析します。
    *   **反応関数**: `取引サイズ = 基本サイズ * センチメントスコア * 確信度`。
    *   **速度**: ニュース発表から数ミリ秒以内に反応します。
    *   **フェード (Fading)**: 一部のリアクターは、初期のスパイク（過剰反応）後の戻りを予測して、逆張りを行う場合があります。

### 3.8. National AI (Central Bank) Logic (国家AI / 中央銀行)
*   **目的**: 経済の安定維持または政策の実施。
*   **挙動**:
    *   **介入 (Intervention)**: 資産クラスが臨界閾値（支持レベル）を下回った場合に購入します。
    *   **利上げ/利下げ**: グローバルな流動性パラメータに影響を与える金利変更をシミュレートします。
    *   **ペッグ維持**: 通貨がペッグされている場合、レートを狭い帯域内に保つために積極的に取引します。
